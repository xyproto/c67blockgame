import "github.com/xyproto/c67game"
import sdl3 as sdl

BLOCK_SIZE := 20
PURPLE := 0xFF00FF
current_x := 4
current_y := 5

piece_T := [0, 1, 0, 0,
            1, 1, 1, 0,
            0, 0, 0, 0,
            0, 0, 0, 0]

sdl.SDL_Init(sdl.SDL_INIT_VIDEO) or! {
    exitln("SDL Init failed!")
}
defer sdl.SDL_Quit()

window := sdl.SDL_CreateWindow("Piece Test", 320, 240, 0) or! {
    exitln("Window creation failed!")
}
defer sdl.SDL_DestroyWindow(window)

renderer := sdl.SDL_CreateRenderer(window, 0) or! {
    exitln("Renderer creation failed!")
}
defer sdl.SDL_DestroyRenderer(renderer)

clear_screen(renderer, 0x000000)

println("Drawing piece...")

@ py in 0..<4 max 4 {
    @ px in 0..<4 max 4 {
        piece_idx := py * 4 + px
        piece_T[piece_idx] != 0 {
            bx := (current_x + px) * BLOCK_SIZE
            by := (current_y + py) * BLOCK_SIZE
            draw_rect(renderer, bx, by, BLOCK_SIZE, BLOCK_SIZE, PURPLE)
        }
    }
}

present(renderer)
delay(2000)

println("Done")
